<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>地震避险小游戏</title>
    <!-- 替换为国内CDN -->
    <script src="https://cdn.bootcdn.net/ajax/libs/ruffle-rs/2023.12.18/ruffle.js"></script>
    <style>
        [原有样式保持不变]
    </style>
</head>
<body>
    [原有body内容保持不变]

    <script>
        // 增加CDN加载失败回退方案
        function loadRuffle() {
            const container = document.getElementById("ruffle-container");
            const ruffle = window.RufflePlayer.newest();
            
            if (!ruffle) {
                console.log("正在尝试备用CDN...");
                // 添加国内备用CDN
                const fallbackScript = document.createElement('script');
                fallbackScript.src = 'https://cdn.baomitu.com/ruffle-rs/2023.12.18/ruffle.js';
                document.head.appendChild(fallbackScript);
                
                // 延迟初始化
                setTimeout(() => {
                    if (window.RufflePlayer) {
                        initializePlayer();
                    } else {
                        container.innerHTML = "<p>游戏加载失败，请刷新重试</p>";
                    }
                }, 2000);
                return;
            }

            initializePlayer();
        }

        function initializePlayer() {
            const container = document.getElementById("ruffle-container");
            const ruffle = window.RufflePlayer.newest();
            const player = ruffle.createPlayer();
            
            player.style.width = "100%";
            player.style.height = "100%";
            container.appendChild(player);
            
            // 加载SWF文件（建议SWF也使用国内CDN）
            player.load("/game.swf").catch((error) => {
                console.error("加载SWF文件失败:", error);
                container.innerHTML = "<p>游戏加载失败，请检查网络连接</p>";
            });
        }

        window.addEventListener("DOMContentLoaded", loadRuffle);
    </script>
</body>
</html>
